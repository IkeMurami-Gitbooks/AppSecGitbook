# Программы лояльности

Программы лояльности базируются на:

* Кешбэк
* Промокоды
* Баллы
* Сертификаты
* Скидки
* ...

Тезисы из статьи с [vc](https://vc.ru/trade/636199-kak-internet-magazin-tasty-coffee-nagreli-na-100-000-rubley-cherez-keshbek-tinkoff-i-drugie-programmy-loyalnosti): с какими фродами столкнулись ребята

## Отмена покупки товара с кешбэком

Оформляем товар с кешбеком, получаем кешбек на карту, отменяем покупку товара — получаем и деньги обратно и кешбек.

* Иногда банки не понимают, что произошел возврат товара, продавец должен сам уведомить банк. В этом случае начилсение кешбека отменится
* Защита:
  * Ограничение максимальной суммы заказа (если дороже — оплата при получении, и соотв кешбек постфактум)
  * Анализ отмененных заказов, обработка подозрительных операций
  * Ограничение в соглашении с банком на максимальную сумму кешбека
  * Есть реестр кешбека от банков: сохраняем ID операций, осуществляем сверку данных с реестром (если заказ отменили — кешбек не переводим клиенту)

## Кешбэк за любую покупку

Денежный кешбек — начисляется за любую покупку (картой или наличкой). Покупаем товар, загружаем чек, получаем кешбек и выводим деньги на карту

* Мошенники грузили авансовые чеки (а не о полном расчете) и возвращали заказ
* Защита:
  * Чеки авансовые должны значительно отличаться от расчетного
  * Проверять реестр заказов, и только после получения заказа, отдавать кешбек

## Комиссия за эквайринг

Некоторые банки берут комиссию за операцию, но они не возвращают ее в случае отмены операции. Это тоже убыток.

## Подарочные сертификаты

### Использование одного сертификата несколько раз

одновременное оформление нескольких корзин на одном сертификате. Сколько то заказов при оплате одновременно будут оплачены по этому сертификату

* Защита:
  * Вести стоимость сертов (чтобы он уходил в минус в случае множественных использований)
  * все финансовые операции нужно выполнять строго последовательно и с блокировкой таблиц (заворачивать все в транзакцию)

### Активация одного сертификата несколько раз

Применяли подарочный сертификат несколько раз к своему аккаунту: он несколько раз зачислялся на счет

### Злоупотребеление системой возврата денег

Если пользователю товар не понравился, бизнес может вернуть деньги, без фактического возврата товара. Но пользователи могут злоупотреблять этой системой.

* Защита:
  * Проверять пользователей по почте, телефону, имени, IP, cookies сайта и user agent, а также данным карты, которой оплачен заказ, адресу доставки.
  * Строить антифрод систему / команду
