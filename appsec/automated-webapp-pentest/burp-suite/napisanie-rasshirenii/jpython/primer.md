# Пример

## Пример с заменой домена

```python
from burp import IBurpExtender
from burp import IHttpListener

HOST_FROM = "127.0.0.1"
HOST_TO = "192.168.1.45"

class BurpExtender(IBurpExtender, IHttpListener):

    #
    # implement IBurpExtender
    #
    
    def  registerExtenderCallbacks(self, callbacks):
        # obtain an extension helpers object
        self._helpers = callbacks.getHelpers()
        
        # set our extension name
        callbacks.setExtensionName("Traffic redirector")
        
        # register ourselves as an HTTP listener
        callbacks.registerHttpListener(self)

    #
    # implement IHttpListener
    #
    
    def processHttpMessage(self, toolFlag, messageIsRequest, messageInfo):
        # only process requests
        if not messageIsRequest:
            return

        # get the HTTP service for the request
        httpService = messageInfo.getHttpService()
        
        # if the host is HOST_FROM, change it to HOST_TO
        if (HOST_FROM == httpService.getHost()):
            messageInfo.setHttpService(self._helpers.buildHttpService(HOST_TO,
                httpService.getPort(), httpService.getProtocol()))
```

## Пример с UI

{% embed url="https://portswigger.net/blog/sample-burp-suite-extension-custom-logger" %}

## 2 хороших примера плагинов&#x20;

Protobuf Decoder: [https://github.com/PortSwigger/protobuf-decoder](https://github.com/PortSwigger/protobuf-decoder)

MessagePack: [https://github.com/PortSwigger/message-pack](https://github.com/PortSwigger/message-pack)

