# Инструменты для Burp

Отправить результат из коллобаротора slack или discord (Go): [https://github.com/projectdiscovery/notify](https://github.com/projectdiscovery/notify)

Collaborator? [https://github.com/projectdiscovery/collaborator](https://github.com/projectdiscovery/collaborator)

## Парсим Site Map из BurpSuite

requirements:

```
jsbeautifier
beautifulsoup4
```

script:

```python
import xml.etree.ElementTree as ET
from base64 import b64decode
from pathlib import Path
import jsbeautifier
from bs4 import BeautifulSoup


def parseXML(xmlfile):
    tree = ET.parse(xmlfile)
    root = tree.getroot()
    items = []
    # print(root.attrib['burpVersion'], root.attrib['exportTime'])

    for item in root:
        url = item.find('url').text
        ip = item.find('host').attrib['ip']
        host = item.find('host').text
        method = item.find('method').text
        path = item.find('path').text
        status = item.find('status').text
        mimetype = item.find('mimetype').text  # HTML, script, JSON
        extension = item.find('extension').text
        isBase64 = item.find('response').attrib['base64']
        response = item.find('response').text
        body = '\n\n'.join(response.split('\n\n')[1:])
        
        # if mimetype not in items:
        #     items[mimetype] = []

        if isBase64 == 'true':
            print(isBase64)
            body = str(b64decode(body))

        items.append({
            'mimetype': mimetype,
            'domain': host,
            'path': '/'.join(filter(lambda p: p != '', path.split('/'))),
            # 'isBase64': isBase64,
            'content': body
        })

    return items


def save(base, item):
    path = item['domain'] + '/' + item['path']
    mimetype = item['mimetype']
    content = item['content']

    if mimetype == 'HTML':
        if len(item['path']) > 0:
            path += '/'

        path += 'index.html'
        bs = BeautifulSoup(content, 'html.parser')  # 'html.parser'
        content = bs.prettify()

    if mimetype == 'script':
        content =  jsbeautifier.beautify(content)

    path = Path(base, path)
    path.parent.mkdir(parents=True, exist_ok=True)
    with Path(path).open(mode='w') as output_stream:
        output_stream.write(content)

if __name__ == '__main__':
    base = '/Users/user/Downloads/musor/py/data'
    items = parseXML('example.xml')
    for item in items:
        save(base, item)
        # print(item['domain'] + '/' + item['path'])
    # print('items', items)

```
