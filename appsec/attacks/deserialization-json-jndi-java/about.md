# About

Приложение десериализует ненадежные данные. Часто приводит к RCE и доступу к серверу.

Приложение уязвимо, если объекты в сериализованном виде могут быть представлены в различных форматах, в зависимости от использованного механизма сериализации:

* Бинарный: Java Native Serialization, Protobuf...
* Смешанный: Binary XML/JSON...
* Текстовый: JSON, XML, YAML..

## Tricks

Based on [PortSwigger Lab](https://portswigger.net/web-security/deserialization/exploiting).

* Можем менять значения
* Можем менять типы данных (например, если используется сравнение без учета типа данных — `$GET["password"] == $password` — можем через смену типов получать неожиданные резулльтаты, например, для PHP это `true`: `0 == "test"`)
* Данные из десериализованного значения может некорректно использоваться дальше (привет, SQLi, Path Traversal, ...)
* Magic методы
  * Это методы и функции, которые нельзя вызвать напрямую, но они вызываются при наступлении определенного события или сценария (например, при десериализации данных)
  * Примеры из PHP: `__constructor()`, `__wakeup()`,
  * Примеры из Python: `__init__`,
  * Примеры из Java: `ObjectInputStream.readObject()`,

## Mitigation

* Избегайте десериализации данных, полученных из недоверенных источников.

Если такой подход невозможен, следующие меры позволят снизить риск:

* Обеспечьте строгое ограничение типа во время десериализации до создания объекта (см. Java Jackson);
* Внедрите проверку целостности (с использованием закрытого ключа) или шифрование сериализованных объектов для предотвращения атак, связанных с созданием подложных объектов или изменением данных;
* Изолируйте код, выполняющий десериализацию, и запускайте его в окружении с минимальными привилегиями;
* Выполняйте логирование и мониторинг всех исключений и ошибок, связанных с десериализацией.
